% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/generate_plot_story.R
\name{generate_plot_story}
\alias{generate_plot_story}
\title{Generate Humanitarian Data Story from ggplot}
\usage{
generate_plot_story(
  plot,
  max_tokens = 300,
  provider = NULL,
  model = NULL,
  clean_response = TRUE
)
}
\arguments{
\item{plot}{A \code{ggplot} object.}

\item{max_tokens}{Max tokens for description.}

\item{provider}{LLM provider.}

\item{model}{LLM model.}

\item{clean_response}{Deprecated. Response is now structured JSON.}
}
\value{
A list containing \verb{$short_desc} and \verb{$long_desc}.
}
\description{
This function takes a ggplot2 object and generates a storytelling narrative.
It now uses a modular architecture (extract_structure,
profile_data, generate_description).
}
\examples{
library(ggplot2)
p <- ggplot(mtcars, aes(x = wt, y = mpg)) +
  geom_point() +
  unhcrthemes::theme_unhcr(grid = "Y", axis = "X", axis_title = FALSE) +
  labs(
    title = "Vehicle Efficiency",
    subtitle = "Fuel consumption vs weight",
    caption = "Source: mtcars dataset"
  )

generate_plot_story(p, provider = "ollama", model = "deepseek-r1")

story <- generate_plot_story(
  p,
  provider = "azure",
  model = "gpt-4.1-mini",
  max_tokens = 300
)
# To use as subtitle:
p + ggplot2::labs(subtitle = story)
}
